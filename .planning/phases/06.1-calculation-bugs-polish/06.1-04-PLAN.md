---
phase: 06.1-calculation-bugs-polish
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - src/App.tsx
  - src/pages/WelcomePage.tsx
  - src/pages/CalculatorPage.tsx
  - src/hooks/useExportPng.ts
  - src/components/export/ExportButton.tsx
autonomous: true

must_haves:
  truths:
    - "Footer shows creator credits and vibe-coded attribution on all pages"
    - "Footer shows Hubbard book attribution in Basic mode calculator page only"
    - "PNG export filenames are descriptive without timestamps"
    - "Basic mode PNG filename is 'Expected Value of Perfect Information for [name].png'"
    - "Advanced mode PNG filename is 'Expected Value of Test - [name].png'"
  artifacts:
    - path: "src/App.tsx"
      provides: "Footer component shared across pages"
    - path: "src/pages/CalculatorPage.tsx"
      provides: "Mode-aware Hubbard attribution"
    - path: "src/hooks/useExportPng.ts"
      provides: "Descriptive filename generation without timestamps"
  key_links:
    - from: "src/hooks/useExportPng.ts"
      to: "generateFilename"
      via: "mode-aware filename pattern"
      pattern: "Expected Value of"
---

<objective>
Update footer to show credits on all pages and improve PNG export filenames.

Purpose: Footer should display proper attribution (creator, AI tools, and Hubbard book in Basic mode). PNG exports should have descriptive filenames without timestamps.

Output: Footer visible on all pages with correct attribution, PNG exports with meaningful filenames.
</objective>

<execution_context>
@/Users/ryan.lucht/.claude/get-shit-done/workflows/execute-plan.md
@/Users/ryan.lucht/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/App.tsx
@src/pages/WelcomePage.tsx
@src/pages/CalculatorPage.tsx
@src/hooks/useExportPng.ts
@src/components/export/ExportButton.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create shared Footer component and add to all pages</name>
  <files>src/App.tsx, src/pages/WelcomePage.tsx, src/pages/CalculatorPage.tsx</files>
  <action>
1. Create a Footer component. Since the footer content varies by page/mode, create it inline or as a simple component.

In WelcomePage.tsx, update the footer (around line 64-71):
```typescript
{/* Footer */}
<footer className="py-6 text-center text-sm text-muted-foreground space-y-2">
  <p>
    Created by{' '}
    <a
      href="https://ryanlucht.com"
      target="_blank"
      rel="noopener noreferrer"
      className="underline hover:text-foreground transition-colors"
    >
      Ryan Lucht
    </a>
    {' '}and 100% vibe-coded by Claude Opus 4.5, GPT-5.2 Pro, GPT-Codex-5.2, and Gemini 3 Pro.
  </p>
  <p>
    EVPI calculation based on{' '}
    <span className="font-medium">"How to Measure Anything"</span>{' '}
    by Douglas Hubbard
  </p>
</footer>
```

2. In CalculatorPage.tsx, add a footer at the bottom of the page (after the main content, around line 368):
```typescript
      </main>

      {/* Footer */}
      <footer className="py-6 text-center text-sm text-muted-foreground space-y-2 max-w-[800px] mx-auto px-4 md:px-6">
        <p>
          Created by{' '}
          <a
            href="https://ryanlucht.com"
            target="_blank"
            rel="noopener noreferrer"
            className="underline hover:text-foreground transition-colors"
          >
            Ryan Lucht
          </a>
          {' '}and 100% vibe-coded by Claude Opus 4.5, GPT-5.2 Pro, GPT-Codex-5.2, and Gemini 3 Pro.
        </p>
        {mode === 'basic' && (
          <p>
            EVPI calculation based on{' '}
            <span className="font-medium">"How to Measure Anything"</span>{' '}
            by Douglas Hubbard
          </p>
        )}
      </footer>
    </div>
  );
```

The Hubbard attribution only shows in Basic mode per the requirements.
  </action>
  <verify>Run `npm run dev`, verify: Welcome page has full footer, Basic mode calculator has full footer with Hubbard line, Advanced mode calculator has footer without Hubbard line</verify>
  <done>Footer shows on all pages with correct attribution, Hubbard line only in Basic mode</done>
</task>

<task type="auto">
  <name>Task 2: Update PNG export filenames to be descriptive</name>
  <files>src/hooks/useExportPng.ts, src/components/export/ExportButton.tsx</files>
  <action>
1. In useExportPng.ts, update the generateFilename function to accept mode and remove timestamps:

First, update the function signature and implementation (around line 74-85):
```typescript
/**
 * Generate export filename based on mode and custom title
 *
 * Filename patterns (no timestamps per requirements):
 * - Basic mode: "Expected Value of Perfect Information for {title}.png"
 * - Advanced mode: "Expected Value of Test - {title}.png"
 * - If no title provided, use default
 *
 * @param mode - 'basic' or 'advanced'
 * @param customTitle - Optional user-provided title
 * @returns Complete filename with .png extension
 */
function generateFilename(mode: 'basic' | 'advanced', customTitle?: string): string {
  const title = customTitle?.trim() || 'My Test';
  const sanitized = sanitizeFilename(title);
  const safeTitle = sanitized || 'my-test';

  if (mode === 'basic') {
    return `Expected Value of Perfect Information for ${safeTitle}.png`;
  } else {
    return `Expected Value of Test - ${safeTitle}.png`;
  }
}
```

2. Update the exportPng callback to accept mode (around line 123):
```typescript
const exportPng = useCallback(async (mode: 'basic' | 'advanced', customTitle?: string) => {
  if (!exportRef.current) {
    console.warn('Export ref not attached to any element');
    return;
  }

  setIsExporting(true);

  try {
    const dataUrl = await toPng(exportRef.current, {
      pixelRatio: 2,
      backgroundColor: '#FFFFFF',
      width: 1080,
      height: 1080,
    });

    // Generate filename based on mode and title
    const filename = generateFilename(mode, customTitle);

    const link = document.createElement('a');
    link.download = filename;
    link.href = dataUrl;
    link.click();
  } catch (error) {
    console.error('Failed to export PNG:', error);
    throw error;
  } finally {
    setIsExporting(false);
  }
}, []);
```

3. Update the return type interface:
```typescript
interface UseExportPngReturn {
  exportRef: React.RefObject<HTMLDivElement | null>;
  exportPng: (mode: 'basic' | 'advanced', customTitle?: string) => Promise<void>;
  isExporting: boolean;
}
```

4. Remove the generateTimestamp function (no longer needed).

5. In ExportButton.tsx, update the handleExport call to pass mode (around line 184):
```typescript
const handleExport = async () => {
  try {
    await exportPng(mode, customTitle || undefined);
  } catch (error) {
    console.error('Export failed:', error);
  }
};
```
  </action>
  <verify>Run `npm run dev`, export PNG in Basic mode - filename should be "Expected Value of Perfect Information for [title].png". Export in Advanced mode - filename should be "Expected Value of Test - [title].png"</verify>
  <done>PNG exports use descriptive filenames without timestamps, different patterns for Basic vs Advanced mode</done>
</task>

</tasks>

<verification>
1. `npm run dev` - Application runs without errors
2. `npm run lint` - No lint errors
3. `npm run typecheck` - No type errors
4. Manual verification:
   - Welcome page: Footer shows "Created by Ryan Lucht..." and Hubbard attribution
   - Basic mode calculator: Footer shows both lines
   - Advanced mode calculator: Footer shows creator line only (no Hubbard)
   - Basic mode PNG export: Filename is "Expected Value of Perfect Information for [title].png"
   - Advanced mode PNG export: Filename is "Expected Value of Test - [title].png"
</verification>

<success_criteria>
- Footer visible on Welcome page with creator credits + Hubbard attribution
- Footer visible on Calculator page with creator credits
- Hubbard attribution only shows in Basic mode calculator
- PNG filename follows "Expected Value of Perfect Information for [name].png" pattern in Basic mode
- PNG filename follows "Expected Value of Test - [name].png" pattern in Advanced mode
- No timestamps in PNG filenames
</success_criteria>

<output>
After completion, create `.planning/phases/06.1-calculation-bugs-polish/06.1-04-SUMMARY.md`
</output>
